# 🧪 Web界面功能测试计划

## 测试环境
- **测试URL**: http://localhost:5000
- **测试设备**: 树莓派3
- **浏览器**: Chrome/Playwright
- **测试日期**: 2025-10-08

---

## 📋 测试用例清单

### 1️⃣ 基础功能测试

#### TC-001: 页面加载测试
- **前置条件**: 服务器运行在树莓派上
- **测试步骤**:
  1. 访问 http://localhost:5000/
  2. 检查页面标题是否为"树莓派GPIO引脚控制面板"
  3. 检查是否显示40个GPIO引脚
- **预期结果**: 
  - ✅ 页面成功加载
  - ✅ 显示所有GPIO引脚信息
  - ✅ 显示控制面板区域

#### TC-002: WebSocket连接测试
- **前置条件**: 页面已加载
- **测试步骤**:
  1. 等待3秒
  2. 检查连接状态显示
- **预期结果**: 
  - ✅ 显示"连接状态: 已连接 ✓"
  - ✅ 系统日志显示"已连接到服务器"

---

### 2️⃣ 引脚模式设置测试

#### TC-003: 设置输出模式
- **测试引脚**: GPIO 17
- **测试步骤**:
  1. 选择GPIO 17
  2. 选择"输出模式 (OUTPUT)"
  3. 点击"设置模式"按钮
- **预期结果**: 
  - ✅ 日志显示成功消息
  - ✅ 引脚图标显示状态 "GPIO 17: LOW (output)"
  - ✅ 无错误消息

#### TC-004: 设置输入模式
- **测试引脚**: GPIO 22
- **测试步骤**:
  1. 选择GPIO 22
  2. 选择"输入模式 (INPUT)"
  3. 点击"设置模式"按钮
- **预期结果**: 
  - ✅ 日志显示成功消息
  - ✅ 引脚图标更新为输入状态
  - ✅ 无错误消息

#### TC-005: 设置输入上拉模式
- **测试引脚**: GPIO 23
- **测试步骤**:
  1. 选择GPIO 23
  2. 选择"输入上拉 (INPUT_PULLUP)"
  3. 点击"设置模式"按钮
- **预期结果**: 
  - ✅ 日志显示成功消息
  - ✅ 引脚状态显示HIGH (上拉默认高电平)
  - ✅ 无错误消息

#### TC-006: 设置输入下拉模式
- **测试引脚**: GPIO 24
- **测试步骤**:
  1. 选择GPIO 24
  2. 选择"输入下拉 (INPUT_PULLDOWN)"
  3. 点击"设置模式"按钮
- **预期结果**: 
  - ✅ 日志显示成功消息
  - ✅ 引脚状态显示LOW (下拉默认低电平)
  - ✅ 无错误消息

---

### 3️⃣ 输出控制测试

#### TC-007: 设置高电平
- **前置条件**: GPIO 17已设置为输出模式
- **测试步骤**:
  1. 在"输出控制"区选择GPIO 17
  2. 点击"设置高电平"按钮
- **预期结果**: 
  - ✅ 日志显示"GPIO 17: Written HIGH"
  - ✅ 引脚状态显示"GPIO 17: HIGH (output)"
  - ✅ 无错误消息

#### TC-008: 设置低电平
- **前置条件**: GPIO 17已设置为输出模式
- **测试步骤**:
  1. 在"输出控制"区选择GPIO 17
  2. 点击"设置低电平"按钮
- **预期结果**: 
  - ✅ 日志显示"GPIO 17: Written LOW"
  - ✅ 引脚状态显示"GPIO 17: LOW (output)"
  - ✅ 无错误消息

#### TC-009: 切换状态
- **前置条件**: GPIO 17已设置为输出模式
- **测试步骤**:
  1. 记录当前状态（假设为LOW）
  2. 在"输出控制"区选择GPIO 17
  3. 点击"切换状态"按钮
  4. 再次点击"切换状态"按钮
- **预期结果**: 
  - ✅ 第一次切换: LOW → HIGH
  - ✅ 第二次切换: HIGH → LOW
  - ✅ 引脚状态正确更新
  - ✅ 无错误消息

---

### 4️⃣ PWM控制测试

#### TC-010: 启动PWM（默认参数）
- **测试引脚**: GPIO 18 (支持硬件PWM)
- **测试步骤**:
  1. 在"PWM控制"区选择GPIO 18
  2. 保持默认频率1000Hz，占空比50%
  3. 点击"启动PWM"按钮
- **预期结果**: 
  - ✅ 日志显示"PWM started on GPIO 18"
  - ✅ 引脚状态显示PWM激活
  - ✅ 无错误消息

#### TC-011: 调整PWM频率
- **前置条件**: GPIO 18的PWM已启动
- **测试步骤**:
  1. 先停止PWM
  2. 修改频率为2000Hz
  3. 点击"启动PWM"按钮
- **预期结果**: 
  - ✅ PWM以新频率启动
  - ✅ 日志显示成功消息
  - ✅ 无错误消息

#### TC-012: 调整PWM占空比
- **前置条件**: GPIO 18的PWM已启动
- **测试步骤**:
  1. 先停止PWM
  2. 拖动占空比滑块到75%
  3. 点击"启动PWM"按钮
- **预期结果**: 
  - ✅ PWM以新占空比启动
  - ✅ 占空比显示更新为75%
  - ✅ 无错误消息

#### TC-013: 停止PWM
- **前置条件**: GPIO 18的PWM正在运行
- **测试步骤**:
  1. 点击"停止PWM"按钮
- **预期结果**: 
  - ✅ 日志显示"PWM stopped on GPIO 18"
  - ✅ 引脚状态恢复正常
  - ✅ 无错误消息

#### TC-014: PWM参数验证（边界测试）
- **测试步骤**:
  1. 尝试设置频率为0Hz（无效）
  2. 尝试设置频率为100000Hz（超出范围）
  3. 尝试设置占空比为-10%（无效）
  4. 尝试设置占空比为150%（无效）
- **预期结果**: 
  - ✅ 显示参数错误提示
  - ✅ PWM不会启动
  - ✅ 日志显示错误原因

---

### 5️⃣ 批量操作测试

#### TC-015: 读取所有引脚状态
- **前置条件**: 部分引脚已配置
- **测试步骤**:
  1. 点击"读取所有引脚"按钮
- **预期结果**: 
  - ✅ 日志显示读取的引脚数量
  - ✅ 所有已配置引脚的状态更新
  - ✅ 无错误消息

#### TC-016: 重置所有引脚
- **前置条件**: 多个引脚已配置为不同模式
- **测试步骤**:
  1. 点击"重置所有引脚"按钮
  2. 观察引脚状态变化
- **预期结果**: 
  - ✅ 所有引脚恢复默认状态
  - ✅ 日志显示重置操作完成
  - ✅ PWM全部停止
  - ✅ 无错误消息

#### TC-017: 清理GPIO
- **前置条件**: GPIO已初始化并使用
- **测试步骤**:
  1. 点击"清理GPIO"按钮
- **预期结果**: 
  - ✅ 日志显示"GPIO cleanup completed"
  - ✅ 所有引脚状态清除
  - ✅ 无错误消息

---

### 6️⃣ 状态显示和实时更新测试

#### TC-018: 引脚状态图标更新
- **测试步骤**:
  1. 设置GPIO 17为输出模式
  2. 观察引脚图标变化
  3. 设置为高电平
  4. 观察引脚图标颜色变化
- **预期结果**: 
  - ✅ 引脚图标实时更新
  - ✅ 高电平显示不同颜色
  - ✅ 低电平显示不同颜色
  - ✅ 悬浮提示显示详细信息

#### TC-019: 系统日志实时更新
- **测试步骤**:
  1. 执行多个GPIO操作
  2. 观察日志区域
- **预期结果**: 
  - ✅ 每个操作都产生日志条目
  - ✅ 日志按时间顺序显示
  - ✅ 成功操作显示为绿色
  - ✅ 错误操作显示为红色

#### TC-020: 读取状态按钮
- **前置条件**: GPIO 22已设置为输入模式
- **测试步骤**:
  1. 选择GPIO 22
  2. 点击"读取状态"按钮
- **预期结果**: 
  - ✅ 日志显示当前引脚状态（HIGH或LOW）
  - ✅ 引脚图标状态更新
  - ✅ 无错误消息

---

### 7️⃣ 错误处理测试

#### TC-021: 设置电源引脚（应失败）
- **测试步骤**:
  1. 尝试选择3V3或5V引脚
- **预期结果**: 
  - ✅ 下拉列表中不包含电源引脚
  - ✅ 或显示不可操作提示

#### TC-022: 设置地线引脚（应失败）
- **测试步骤**:
  1. 尝试选择GND引脚
- **预期结果**: 
  - ✅ 下拉列表中不包含GND引脚
  - ✅ 或显示不可操作提示

#### TC-023: 连接断开重连测试
- **测试步骤**:
  1. 正常连接后
  2. 重启后端服务器
  3. 观察前端反应
  4. 等待自动重连
- **预期结果**: 
  - ✅ 显示"连接状态: 未连接"
  - ✅ 自动尝试重连
  - ✅ 重连成功后显示"已连接 ✓"
  - ✅ 日志显示连接状态变化

#### TC-024: 无效操作测试
- **测试步骤**:
  1. 在输入模式的引脚上尝试写入操作
  2. 观察错误提示
- **预期结果**: 
  - ✅ 显示错误消息
  - ✅ 日志说明错误原因
  - ✅ 不会造成系统崩溃

---

### 8️⃣ 性能和稳定性测试

#### TC-025: 快速连续操作测试
- **测试步骤**:
  1. 快速连续点击"设置高电平"和"设置低电平"按钮20次
  2. 观察系统响应
- **预期结果**: 
  - ✅ 所有操作都得到响应
  - ✅ 日志正确记录所有操作
  - ✅ 无丢失或错乱
  - ✅ 系统保持稳定

#### TC-026: 多引脚同时操作测试
- **测试步骤**:
  1. 配置5个不同引脚为输出模式
  2. 快速切换各引脚状态
  3. 启动2个PWM
- **预期结果**: 
  - ✅ 所有引脚独立工作
  - ✅ PWM互不干扰
  - ✅ 状态更新准确
  - ✅ 系统保持稳定

#### TC-027: 长时间运行测试
- **测试步骤**:
  1. 启动PWM
  2. 保持运行30分钟
  3. 定期检查状态
- **预期结果**: 
  - ✅ PWM持续稳定运行
  - ✅ Web界面保持响应
  - ✅ 无内存泄漏
  - ✅ 无连接断开

---

## 📊 测试优先级

### P0 - 高优先级（必须通过）
- TC-001: 页面加载
- TC-002: WebSocket连接
- TC-003: 设置输出模式
- TC-007: 设置高电平
- TC-008: 设置低电平
- TC-017: 清理GPIO

### P1 - 中优先级（重要功能）
- TC-004~TC-006: 其他模式设置
- TC-009: 切换状态
- TC-010~TC-013: PWM基本操作
- TC-015~TC-016: 批量操作
- TC-020: 读取状态

### P2 - 低优先级（辅助功能）
- TC-014: PWM参数验证
- TC-018~TC-019: UI更新
- TC-021~TC-024: 错误处理
- TC-025~TC-027: 性能测试

---

## 🔧 测试执行方式

### 手动测试（推荐先进行）
```bash
# 1. 启动服务器
ssh pi@raspberrypi "cd /home/pi/gpio && bash start.sh --daemon"

# 2. 在浏览器中打开 http://localhost:5000

# 3. 按照测试用例逐个测试

# 4. 记录测试结果
```

### 自动化测试（Playwright）
```bash
# 使用Playwright进行自动化测试
# 后续可以编写自动化测试脚本
```

---

## 📝 测试结果记录模板

```markdown
### 测试执行记录

**测试日期**: YYYY-MM-DD
**测试人员**: 
**测试环境**: 树莓派3 + Chrome

| 用例编号 | 用例名称 | 结果 | 备注 |
|---------|---------|------|------|
| TC-001  | 页面加载 | ✅/❌ |      |
| TC-002  | 连接测试 | ✅/❌ |      |
| ...     | ...     | ...  | ...  |

**发现的问题**:
1. 
2. 

**总体评价**:
- 通过率: ___%
- 严重问题: __个
- 一般问题: __个
```

---

## 💡 测试注意事项

1. **硬件安全**: 
   - 测试前确认没有连接敏感设备到GPIO引脚
   - 避免短路或过载

2. **测试顺序**: 
   - 建议按用例编号顺序执行
   - 某些用例有依赖关系

3. **数据记录**: 
   - 详细记录每个测试的结果
   - 截图保存错误信息

4. **环境准备**: 
   - 确保pigpio服务运行正常
   - 检查日志输出配置

---

**准备好开始测试了吗？** 🚀

